javascript:(function()%7Basync%20function%20extractPageData()%7Bconst%20rando%20%3D%20(n)%20%3D%3E%20Math.round(Math.random()%20*%20n)%3Bconst%20delay%20%3D%20(ms)%20%3D%3E%20new%20Promise(res%20%3D%3E%20setTimeout(res%2C%20ms))%3Bconst%20unqHsh%20%3D%20(a%2Co)%20%3D%3E%20a.filter(i%3D%3E%20o.hasOwnProperty(i)%20%3F%20false%20%3A%20(o%5Bi%5D%20%3D%20true))%3Basync%20function%20scrollLoop()%7Blet%20list_items%20%3D%20Array.from(document.getElementsByClassName('tab-list-item-mini'))%3F.length%20%3F%20Array.from(document.getElementsByClassName('tab-list-item-mini'))%20%3A%20Array.from(document.getElementsByClassName('tab-list-item'))%3Blet%20loading_elm%20%3D%20document.getElementsByClassName('item-loading')%3F.%5B0%5D%3Bif(list_items%3F.length)%7Bif(list_items.at(-10))%20list_items.at(-10).scrollIntoView(%7Bbehavior%3A%20%22smooth%22%2Cblock%3A%20%22end%22%2Cinline%3A%20%22end%22%7D)%3B%7Dawait%20delay(1111)%3Blet%20total_posts%20%3D%20window.__INITIAL_STATE__%3F.pageData%3F.data%3F.baseInfo%3F.page%3F.total%3Bif(list_items%3F.length)%7Blist_items.at(-1).scrollIntoView(%7Bbehavior%3A%20%22smooth%22%2Cblock%3A%20%22end%22%2Cinline%3A%20%22end%22%7D)%3Bdocument.getElementsByClassName('__panel')%5B2%5D.scrollTo(0%2Cdocument.getElementsByClassName('__panel')%5B2%5D.scrollHeight)%3Bawait%20delay(1111)%3Bif(document.getElementsByClassName('item-loading')%5B0%5D)%20document.getElementsByClassName('item-loading')%5B0%5D.scrollIntoView(%7Bbehavior%3A%20%22smooth%22%2Cblock%3A%20%22end%22%2Cinline%3A%20%22end%22%7D)%3B%7Dconsole.log(%2F%5Cbno%20more%5Cb%7C%E6%B2%A1%E6%9C%89%E6%9B%B4%E5%A4%9A%E4%BA%86%2Fi.exec(document.body.innerText)%3F.%5B0%5D)%3Bconsole.log(Array.from(document.querySelectorAll('div')).filter(r%3D%3E%20%2F%E6%B2%A1%E6%9C%89%E6%9B%B4%E5%A4%9A%E4%BA%86%7C%5Cbno%20more%5Cb%2Fi.test(r.innerText)))%3Breturn%20Object.entries(window.__INITIAL_STATE__%3F.pageData%3F.dataList).some(kv%3D%3E%20kv%5B1%5D.length%20%3E%20total_posts)%3B%2F*%20total_posts%20%3D%3D%20Object.entries(window.__INITIAL_STATE__%3F.pageData%3F.dataList)%3F.%5B0%5D%3F.%5B1%5D%3F.length%3B%20*%2F%7Dfor(let%20i%3D0%3B%20i%3C1000%3B%20i%2B%2B)%7Blet%20res%20%3D%20await%20scrollLoop()%3Bif(res)%20break%3Bif(Array.from(document.querySelectorAll('div')).filter(r%3D%3E%20%2F%E6%B2%A1%E6%9C%89%E6%9B%B4%E5%A4%9A%E4%BA%86%7C%5Cbno%20more%5Cb%2Fi.test(r.innerText))%3F.length)%20break%3B%7Dfunction%20unqKey(array%2Ckey)%7B%20%20var%20q%20%3D%20%5B%5D%3B%20%20var%20map%20%3D%20new%20Map()%3B%20%20for%20(const%20item%20of%20array)%20%7B%20%20%20%20if(!map.has(item%5Bkey%5D))%7B%20%20%20%20%20%20%20%20map.set(item%5Bkey%5D%2C%20true)%3B%20%20%20%20%20%20%20%20q.push(item)%3B%20%20%20%20%7D%20%20%7D%20%20return%20q%3B%7Dreturn%20unqKey(Object.entries(window.__INITIAL_STATE__%3F.pageData%3F.dataList)%3F.map(kv%3D%3E%20%7Breturn%20kv%5B1%5D%3F.map(r%3D%3E%20%7Blet%20obj%20%3D%20snakeCaseObject(r)%3Blet%20content%20%3D%20snakeCaseObject(obj.content)%3Bdelete%20obj.content%3Breturn%20%7B...obj%2C...content%2C%7D%7D)%7D).flat()%2C'content_id')%7Dvar%20cleanObject%20%3D%20(ob)%20%3D%3EObject.entries(ob).reduce((r%2C%20%5Bk%2C%20v%5D)%20%3D%3E%20%7Bif(%20v%20!%3D%20null%20%26%26%20v%20!%3D%20undefined%20%26%26%20v%20!%3D%3D%20%22%22%20%26%26%20(%20%5B'string'%2C'number'%2C'boolean'%2C'function'%2C'symbol'%5D.some(opt%3D%3E%20typeof%20v%20%3D%3D%20opt)%20%7C%7C%20(typeof%20v%20%3D%3D%20'object'%20%26%26%20((Array.isArray(v)%20%26%26%20v.length)%20%7C%7C%20(Array.isArray(v)%20!%3D%20true)%20)%20)%20)%20)%20%7Br%5Bk%5D%20%3D%20v%3Breturn%20r%3B%7D%20else%20%7Breturn%20r%3B%7D%7D%2C%20%7B%7D)%3Bvar%20snakeCaser%20%3D%20(s)%20%3D%3E%20s.split(%2F(%3F%3C%3D%5Ba-z%5D)%5CB(%3F%3D%5BA-Z%5D)%2F).map(i%3D%3E%20i.toLowerCase()).reduce((a%2Cb)%3D%3E%20a%2B'_'%2Bb)%3Bfunction%20snakeCaseObject(obj)%7Bvar%20tsvReady%20%3D%20(s)%20%3D%3E%20s%20%3F%20s.replace(%2F%5Ct%7C%5Cu0009%7C%26%239%3B%2Fg%2C%20'%20').replace(%2F%5B%5Cr%5Cn%5D%2B%2Fg%2C%20'%E2%86%B5').replace(%2F%5Cu2029%7C%5Cu2028%7C%5Cx85%7C%5Cx1e%7C%5Cx1d%7C%5Cx1c%7C%5Cx0c%7C%5Cx0b%2Fg%2C'%E2%86%B5').replace(%2F%22%2Fg%2C%20%22'%22)%20%3A%20s%3Breturn%20obj%20%3F%20cleanObject(Object.entries(obj).map(kv%3D%3E%20%7Blet%20val%20%3D%20typeof%20kv%5B1%5D%20%3D%3D%20'object'%20%26%26%20Array.isArray(kv%5B1%5D)%20%3F%20kv%5B1%5D.map(v%3D%3E%20snakeCaseObject(v))%3A%20kv%5B1%5D%20%26%26%20typeof%20kv%5B1%5D%20%3D%3D%20'object'%20%3F%20snakeCaseObject(kv%5B1%5D)%3A%20typeof%20kv%5B1%5D%20%3D%3D%20'string'%20%3F%20tsvReady(kv%5B1%5D.trim())%20%3A%20kv%5B1%5D%3Breturn%20%7B...(%2F%5E%5C%24%2F.test(kv%5B0%5D)%20%3F%20%7B%7D%20%3A%20%7B%5BsnakeCaser(kv%5B0%5D.replace(%2F%5Ejs%2F%2C''))%5D%3Aval%7D)%7D%7D).reduce((a%2Cb)%3D%3E%20%7Breturn%20%7B...a%2C...b%7D%7D))%20%3A%20%7B%7D%7Dasync%20function%20handleFetch(url%2Cparams_obj%2Ctype)%7Bconst%20delay%20%3D%20(ms)%20%3D%3E%20new%20Promise(res%20%3D%3E%20setTimeout(res%2C%20ms))%3Btry%7Basync%20function%20handleResponse(res%2Ctype)%7Bif(type%20%3D%3D%20'json')%20return%20await%20res.json().catch(err%3D%3E%20%7B%20console.log(%5Berr%2Curl%2Cparams_obj%5D)%3B%20return%20false%20%7D)%3Bif(type%20%3D%3D%20'text')%20return%20await%20res.text().catch(err%3D%3E%20%7B%20console.log(%5Berr%2Curl%2Cparams_obj%5D)%3B%20return%20false%20%7D)%3Bif(type%20%3D%3D%20'html')%20%7Blet%20text%20%3D%20await%20res.text().catch(err%3D%3E%20%7B%20console.log(%5Berr%2Curl%2Cparams_obj%5D)%3B%20return%20false%20%7D)%3Breturn%20new%20DOMParser().parseFromString(text%2C'text%2Fhtml')%3B%7Delse%7B%20return%20false%20%7D%7Dif(params_obj%20%26%26%20url)%7Bvar%20res%20%3D%20await%20fetch(url%2Cparams_obj).catch(err%3D%3E%20%7B%20console.log(%5Berr%2Curl%2Cparams_obj%5D)%3B%20return%20false%20%7D)%3Bif(res.status%20%3E%20199%20%26%26%20res.status%20%3C%20300)%20return%20await%20handleResponse(res%2Ctype)%3Bif(res.status%20%3D%3D%20429)%20%7Bawait%20delay(300000)%3Blet%20res%20%3D%20await%20fetch(url%2Cparams_obj).catch(err%3D%3E%20%7B%20console.log(%5Berr%2Curl%2Cparams_obj%5D)%3B%20return%20false%20%7D)%3Bif(res.status%20%3E%20199%20%26%26%20res.status%20%3C%20300)%20return%20await%20handleResponse(res%2Ctype)%3Belse%20return%20%7Baction%3A%20'stop'%2C%20status%3A%20res.status%7D%3B%7Dif(res.status%20%3E%20399%20%26%26%20res.status%20%3C%20900)%7Bawait%20delay(4410)%3Blet%20res%20%3D%20await%20fetch(url%2Cparams_obj).catch(err%3D%3E%20%7B%20console.log(%5Berr%2Curl%2Cparams_obj%5D)%3B%20return%20false%20%7D)%3Bif(res.status%20%3E%20199%20%26%26%20res.status%20%3C%20300)%20return%20await%20handleResponse(res%2Ctype)%3Belse%20return%20%7Baction%3A%20'stop'%2C%20status%3A%20res.status%7D%3B%7Dif(res.status%20%3E%20899)%20return%20%7Baction%3A%20'stop'%2C%20status%3A%20res.status%7D%3B%7D%20else%20%7Breturn%20false%3B%7D%7Dcatch(err)%7Bconsole.log(err)%3Breturn%20false%3B%7D%7Dfunction%20parseProfileInfo(doc)%7Bvar%20location_map%20%3D%20%7B%22%E5%B9%BF%E4%B8%9C%E7%9C%81%22%3A%22Guangdong%20Province%22%2C%22%E4%B8%8A%E6%B5%B7%E5%B8%82%22%3A%22Shanghai%20Municipality%22%2C%22%E5%8C%97%E4%BA%AC%E5%B8%82%22%3A%22Beijing%20Municipality%22%2C%22%E6%B1%9F%E8%8B%8F%E7%9C%81%22%3A%22Jiangsu%20Province%22%2C%22%E6%B2%B3%E5%8D%97%E7%9C%81%22%3A%22Henan%20Province%22%2C%22%E5%90%89%E6%9E%97%E7%9C%81%22%3A%22Jilin%20Province%22%2C%22%E5%9B%9B%E5%B7%9D%E7%9C%81%22%3A%22Sichuan%20Province%22%2C%22%E6%B5%99%E6%B1%9F%E7%9C%81%22%3A%22Zhejiang%20Province%22%2C%22%E9%99%95%E8%A5%BF%E7%9C%81%22%3A%22Shaanxi%20Province%22%2C%22%E5%B1%B1%E8%A5%BF%E7%9C%81%22%3A%22Shanxi%20Province%22%2C%22%E9%A6%99%E6%B8%AF%22%3A%22Hong%20Kong%22%2C%22%E7%A6%8F%E5%BB%BA%E7%9C%81%22%3A%22Fujian%20Province%22%2C%22%E8%B4%B5%E5%B7%9E%E7%9C%81%22%3A%22Guizhou%20Province%22%2C%22%E6%B9%96%E5%8D%97%E7%9C%81%22%3A%22Hunan%20Province%22%2C%22%E6%B9%96%E5%8C%97%E7%9C%81%22%3A%22Hubei%20Province%22%2C%22%E6%B2%B3%E5%8C%97%E7%9C%81%22%3A%22Hebei%20Province%22%2C%22%E5%B1%B1%E4%B8%9C%E7%9C%81%22%3A%22Shandong%20Province%22%2C%22%E5%AE%89%E5%BE%BD%E7%9C%81%22%3A%22Anhui%20Province%22%2C%22%E5%A4%A9%E6%B4%A5%E5%B8%82%22%3A%22Tianjin%20Municipality%22%2C%22%E5%86%85%E8%92%99%E5%8F%A4%22%3A%22Inner%20Mongolia%22%2C%7D%3Bvar%20location_name%20%3D%20doc%3F.getElementsByClassName('user-profile-head-address')%3F.%5B0%5D%3F.getElementsByClassName('address')%3F.%5B0%5D%3F.innerText%3F.replace(%2F.%2B%3F(%3A%7C%EF%BC%9A)%2F%2C'')%3Breturn%20%7B...%7Blocation%3Alocation_map%5Blocation_name%5D%20%3F%20location_map%5Blocation_name%5D%20%3A%20location_name%2Cjoin_date%3Adoc%3F.getElementsByClassName('user-general-info-join-csdn')%3F.%5B0%5D%3F.getElementsByClassName('user-general-info-key-word')%3F.%5B0%5D%3F.innerText%3F.trim()%7D%2C...(doc%3F.getElementsByClassName('user-profile-head-info-r-c')%3F.%5B0%5D%3F%20Array.from(doc%3F.getElementsByClassName('user-profile-head-info-r-c')%3F.%5B0%5D%3F.getElementsByTagName('li'))%3F.map((itm%2Ci)%3D%3E%20%7Blet%20header%20%3D%20%60be_visited%2Coriginal%2Cranking%2Cfan%2Ciron_powder%60.split(%2F%2C%2F)%3Breturn%20%7B%5Bheader%5Bi%5D%5D%3Aitm.getElementsByClassName('user-profile-statistics-num')%3F.%5B0%5D%3F.innerText%3F.trim()%3F.replace(%2F%2C%2F%2C'')%7D%7D).reduce((a%2Cb)%3D%3E%20%7Breturn%20%7B...a%2C...b%7D%7D)%3A%20%7B%7D)%7D%7Dasync%20function%20enrichWithBlogInfo(obj)%7Bvar%20doc%20%3D%20await%20handleFetch(%60https%3A%2F%2Fblog.csdn.net%2F%24%7Bobj.username%7D%3Ftype%3Dbbs%60%2C%7B%7D%2C'html')%3Breturn%20%7B...%7Busername%3Aobj.username%7D%2C...parseProfileInfo(doc)%7D%7Dfunction%20convert2TsvAndDownload(records%2C%20named_file)%7Bvar%20fileArray%20%3D%20records%3Bvar%20tsvReady%20%3D%20(s)%20%3D%3E%20s%20%3F%20s.replace(%2F%5Ct%7C%5Cu0009%7C%26%239%3B%2Fg%2C%20'%20').replace(%2F%5B%5Cr%5Cn%5D%2B%2Fg%2C%20'%E2%86%B5').replace(%2F%5Cu2029%7C%5Cu2028%7C%5Cx85%7C%5Cx1e%7C%5Cx1d%7C%5Cx1c%7C%5Cx0c%7C%5Cx0b%2Fg%2C'%E2%86%B5').replace(%2F%22%2Fg%2C%20%22'%22)%20%3A%20s%3Bvar%20unqHsh%20%3D%20(a%2C%20o)%20%3D%3E%20a.filter(i%20%3D%3E%20o.hasOwnProperty(i)%20%3F%20false%20%3A%20(o%5Bi%5D%20%3D%20true))%3Bvar%20unq%20%3D%20(arr)%20%3D%3E%20arr.filter((e%2C%20p%2C%20a)%20%3D%3E%20a.indexOf(e)%20%3D%3D%20p)%3Bvar%20str%20%3D%20(o)%20%3D%3E%20typeof%20o%20%3D%3D%20'object'%20%3F%20tsvReady(JSON.stringify(o).replace(%2F%5Cn%7C%5Cr%2Fg%2C%20'%20'))%20%3A%20o%3Bvar%20firstLevel%20%3D%20fileArray.map(el%20%3D%3E%20Object.entries(el))%3Bvar%20header%20%3D%20unqHsh(firstLevel.map(el%20%3D%3E%20el.map(itm%20%3D%3E%20itm%5B0%5D)).flat()%2C%7B%7D)%3Bvar%20table%20%3D%20%5Bheader%5D%3Bfor%20(var%20i%20%3D%200%3B%20i%20%3C%20firstLevel.length%3B%20i%2B%2B)%20%7Bvar%20arr%20%3D%20%5B%5D%3Bvar%20row%20%3D%20%5B%5D%3Bvar%20record%20%3D%20firstLevel%5Bi%5D%3Bfor%20(var%20s%20%3D%200%3B%20s%20%3C%20record.length%3B%20s%2B%2B)%20%7Bvar%20record_kv%20%3D%20record%5Bs%5D%3Bvar%20col_key%20%3D%20record_kv%5B0%5D%3Bvar%20place%20%3D%20header.indexOf(col_key)%3Barr%5Bplace%5D%20%3D%20record_kv%5B1%5D%3B%7Dfor%20(var%20a%20%3D%200%3B%20a%20%3C%20arr.length%3B%20a%2B%2B)%20%7Bif%20(arr%5Ba%5D)%20%7Brow.push(arr%5Ba%5D)%3B%7D%20else%20%7Brow.push('')%3B%7D%7Dtable.push(row)%3B%7Dfunction%20downloadr(arr2D%2C%20filename)%20%7Bvar%20data%20%3D%20%2F%5C.json%24%7C.js%24%2F.test(filename)%20%3F%20JSON.stringify(arr2D)%20%3A%20arr2D.map(el%20%3D%3E%20el.reduce((a%2C%20b)%20%3D%3E%20a%20%2B%20'%5Ct'%20%2B%20b)).reduce((a%2C%20b)%20%3D%3E%20a%20%2B%20'%5Cr'%20%2B%20b)%3Bvar%20type%20%3D%20%2F%5C.json%24%7C.js%24%2F.test(filename)%20%3F%20'data%3Aapplication%2Fjson%3Bcharset%3Dutf-8%2C'%20%3A%20'data%3Atext%2Fplain%3Bcharset%3Dutf-8%2C'%3Bvar%20file%20%3D%20new%20Blob(%5Bdata%5D%2C%20%7Btype%3A%20type%7D)%3Bif%20(window.navigator.msSaveOrOpenBlob)%20%7Bwindow.navigator.msSaveOrOpenBlob(file%2C%20filename)%3B%7D%20else%20%7Bvar%20a%20%3D%20document.createElement('a')%2Curl%20%3D%20URL.createObjectURL(file)%3Ba.href%20%3D%20url%3Ba.download%20%3D%20filename%3Bdocument.body.appendChild(a)%3Ba.click()%3BsetTimeout(()%20%3D%3E%20%7Bdocument.body.removeChild(a)%3Bwindow.URL.revokeObjectURL(url)%3B%7D%2C%2010)%3B%7D%7Dvar%20output_%20%3D%20table.map(el%20%3D%3E%20el.map(itm%20%3D%3E%20str(itm)))%3Bdownloadr(output_%2C%20named_file)%3B%7Dasync%20function%20loopThroughPages()%7Bfunction%20unqKey(array%2Ckey)%7B%20%20var%20q%20%3D%20%5B%5D%3B%20%20var%20map%20%3D%20new%20Map()%3B%20%20for%20(const%20item%20of%20array)%20%7B%20%20%20%20if(!map.has(item%5Bkey%5D))%7B%20%20%20%20%20%20%20%20map.set(item%5Bkey%5D%2C%20true)%3B%20%20%20%20%20%20%20%20q.push(item)%3B%20%20%20%20%7D%20%20%7D%20%20return%20q%3B%7Dconsole.log('getting%20posts')%3Blet%20posts%20%3D%20await%20extractPageData()%3Blet%20unq_users%20%3D%20unqKey(posts%2C'username')%3Blet%20contain_arr%20%3D%20%5B%5D%3Bconsole.log('enriching')%3Bfor(let%20i%3D0%3B%20i%3Cunq_users.length%3B%20i%2B%2B)%7Blet%20user_info%20%3D%20await%20enrichWithBlogInfo(unq_users%5Bi%5D)%3Bcontain_arr.push(user_info)%3Bconsole.log(i)%3B%7Dlet%20enriched_posts%20%3D%20posts.map(post%3D%3E%20%7Blet%20user%20%3D%20contain_arr.filter(r%3D%3E%20r.username%20%3D%3D%20post.username)%3Breturn%20%7B...post%2C...user%3F.%5B0%5D%2C%7D%7D)%3Bconvert2TsvAndDownload(enriched_posts%2C%60%24%7B%2F(%3F%3C%3D%5C%2F).%2B%3F(%3F%3D%5C%3F)%2F.exec(window.location.href)%3F.%5B0%5D%7D%20enriched%20posts.tsv%60)%3B%7DloopThroughPages()%7D)()
